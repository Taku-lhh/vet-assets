<!-- ================================================================
  ğŸ¾ å‹•ç‰©ç—…é™¢AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ åŸ‹ã‚è¾¼ã¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ v1.0
  
  ã€ä½¿ã„æ–¹ã€‘
  1. ä¸‹ã®ã€ŒSETTINGSã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ4é …ç›®ï¼‰ã‚’ç—…é™¢ã”ã¨ã«æ›¸ãæ›ãˆã‚‹
  2. ã“ã®ã‚³ãƒ¼ãƒ‰å…¨ä½“ã‚’ã€é¡§å®¢ã‚µã‚¤ãƒˆã® </body> ç›´å‰ã«è²¼ã‚Šä»˜ã‘ã‚‹
  3. å‹•ä½œç¢ºèªã—ã¦å®Œäº†
  
  â€» SETTINGSä»¥å¤–ã®ã‚³ãƒ¼ãƒ‰ã¯ç·¨é›†ä¸è¦ã§ã™
================================================================ -->

<!-- â”â”â”â”â”â” STEP 1: SETTINGSï¼ˆç—…é™¢ã”ã¨ã«æ›¸ãæ›ãˆï¼‰â”â”â”â”â”â” -->
<script>
var VET_CHAT_CONFIG = {

  // (1) Difyãƒˆãƒ¼ã‚¯ãƒ³ã€å¿…é ˆã€‘
  //     Difyã‚¢ãƒ—ãƒªã®å…¬é–‹è¨­å®šã‹ã‚‰å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘
  token: 'ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘',

  // (2) ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒURLã€ä»»æ„ã€‘
  //     ç©ºæ¬„ '' ã®ã¾ã¾ã ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è‚‰çƒã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
  //     ç—…é™¢ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ã†å ´åˆã¯URLã‚’æŒ‡å®š
  //     ä¾‹: 'https://ã‚ãªãŸã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å.github.io/vet-assets/icons/ç—…é™¢å.png'
  iconUrl: '',

  // (3) ãƒ†ãƒ¼ãƒã‚«ãƒ©ãƒ¼ã€ä»»æ„ã€‘
  //     ç—…é™¢ã®ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ã‚’æŒ‡å®šï¼ˆãƒãƒ–ãƒ«ãƒœã‚¿ãƒ³ã®èƒŒæ™¯è‰²ã«ãªã‚Šã¾ã™ï¼‰
  //     ä¾‹: '#4CAF50'ï¼ˆç·‘ï¼‰, '#2196F3'ï¼ˆé’ï¼‰, '#FF9800'ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ï¼‰
  themeColor: '#4CAF50',

  // (4) ãƒœã‚¿ãƒ³ä½ç½®ã€ä»»æ„ã€‘
  //     'right' = ç”»é¢å³ä¸‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
  //     'left'  = ç”»é¢å·¦ä¸‹
  position: 'right',

};
</script>
<!-- â”â”â”â”â”â” SETTINGS ã“ã“ã¾ã§ â”â”â”â”â”â” -->


<!-- â”â”â”â”â”â” ä»¥ä¸‹ã¯ç·¨é›†ä¸è¦ â”â”â”â”â”â” -->

<!-- STEP 2: Dify embed.js ã®èª­ã¿è¾¼ã¿ -->
<script>
window.difyChatbotConfig = { token: VET_CHAT_CONFIG.token };
</script>
<script src="https://udify.app/embed.min.js" id="vet-ai-embed" defer></script>

<!-- STEP 3: ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆå…¨ç—…é™¢å…±é€šï¼‰ -->
<style>
/* â”€â”€â”€ CSSå¤‰æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼‰ â”€â”€â”€ */
:root {
  --vet-theme: #4CAF50;
  --vet-btn-size: 64px;
  --vet-btn-bottom: 20px;
  --vet-btn-side: 20px;
}

/* â”€â”€â”€ ãƒãƒ–ãƒ«ãƒœã‚¿ãƒ³ â”€â”€â”€ */
#dify-chatbot-bubble-button {
  position: fixed !important;
  bottom: var(--vet-btn-bottom) !important;
  right: var(--vet-btn-side) !important;
  left: unset !important;
  width: var(--vet-btn-size) !important;
  height: var(--vet-btn-size) !important;
  padding: 0 !important;
  background-color: var(--vet-theme) !important;
  background-image: none !important;
  background-size: 60% !important;
  background-position: center !important;
  background-repeat: no-repeat !important;
  border: none !important;
  border-radius: 50% !important;
  box-shadow: 0 4px 16px rgba(0,0,0,0.18) !important;
  cursor: pointer !important;
  z-index: 9999 !important;
  animation: vet-bounce 0.5s ease 3;
  transition: transform 0.2s ease, box-shadow 0.2s ease !important;
  overflow: hidden !important;
}

#dify-chatbot-bubble-button:hover {
  transform: scale(1.08) !important;
  box-shadow: 0 6px 24px rgba(0,0,0,0.25) !important;
}

/* Difyãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’éè¡¨ç¤ºã«ã™ã‚‹ */
#dify-chatbot-bubble-button > * {
  display: none !important;
}

/* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè‚‰çƒã‚¢ã‚¤ã‚³ãƒ³ï¼ˆSVGã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ï¼‰ */
#dify-chatbot-bubble-button::after {
  content: '' !important;
  display: block !important;
  width: 55% !important;
  height: 55% !important;
  position: absolute !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBmaWxsPSJ3aGl0ZSI+CiAgPCEtLSDjg6HjgqTjg7Pjg5Hjg4Pjg4kgLS0+CiAgPGVsbGlwc2UgY3g9IjUwIiBjeT0iNjUiIHJ4PSIyMiIgcnk9IjE4Ii8+CiAgPCEtLSDlt6bkuIrjga7mjIfjg5Hjg4Pjg4kgLS0+CiAgPGVsbGlwc2UgY3g9IjI1IiBjeT0iMzgiIHJ4PSIxMCIgcnk9IjEyIiB0cmFuc2Zvcm09InJvdGF0ZSgtMTUgMjUgMzgpIi8+CiAgPCEtLSDlj7PkuIrjga7mjIfjg5Hjg4Pjg4kgLS0+CiAgPGVsbGlwc2UgY3g9Ijc1IiBjeT0iMzgiIHJ4PSIxMCIgcnk9IjEyIiB0cmFuc2Zvcm09InJvdGF0ZSgxNSA3NSAzOCkiLz4KICA8IS0tIOW3puOBruaMh+ODkeODg+ODiSAtLT4KICA8ZWxsaXBzZSBjeD0iMzMiIGN5PSIyOCIgcng9IjgiIHJ5PSIxMCIgdHJhbnNmb3JtPSJyb3RhdGUoLTUgMzMgMjgpIi8+CiAgPCEtLSDlj7Pjga7mjIfjg5Hjg4Pjg4kgLS0+CiAgPGVsbGlwc2UgY3g9IjY3IiBjeT0iMjgiIHJ4PSI4IiByeT0iMTAiIHRyYW5zZm9ybT0icm90YXRlKDUgNjcgMjgpIi8+Cjwvc3ZnPgo=") !important;
  background-size: contain !important;
  background-repeat: no-repeat !important;
  background-position: center !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: none !important;
}

/* åˆå›ãƒã‚¦ãƒ³ã‚¹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ3å›ã§åœæ­¢ï¼‰ */
@keyframes vet-bounce {
  0%, 100% { transform: scale(1); }
  40%      { transform: scale(1.15); }
  60%      { transform: scale(0.95); }
}

/* â”€â”€â”€ ãƒãƒ£ãƒƒãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ â”€â”€â”€ */
#dify-chatbot-bubble-window {
  position: fixed !important;
  bottom: calc(var(--vet-btn-bottom) + var(--vet-btn-size) + 14px) !important;
  right: var(--vet-btn-side) !important;
  left: unset !important;
  top: auto !important;
  width: min(24rem, calc(100vw - 40px)) !important;
  height: min(38rem, calc(100vh - 140px)) !important;
  border-radius: 12px !important;
  box-shadow: 0 8px 40px rgba(0,0,0,0.15) !important;
  z-index: 9999 !important;
}

/* â”€â”€â”€ ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï¼ˆ768pxä»¥ä¸‹ï¼‰ â”€â”€â”€ */
@media (max-width: 768px) {
  :root {
    --vet-btn-size: 56px;
  }
  #dify-chatbot-bubble-window {
    width: min(22rem, calc(100vw - 32px)) !important;
    height: min(34rem, calc(100vh - 120px)) !important;
  }
}

/* â”€â”€â”€ ã‚¹ãƒãƒ›ï¼ˆ480pxä»¥ä¸‹ï¼‰ â”€â”€â”€ */
@media (max-width: 480px) {
  :root {
    --vet-btn-size: 52px;
    --vet-btn-bottom: 16px;
    --vet-btn-side: 16px;
  }
  #dify-chatbot-bubble-button {
    animation: none !important;
  }
  #dify-chatbot-bubble-window {
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100% !important;
    height: 100vh !important;
    height: 100dvh !important;
    max-height: 100dvh !important;
    border-radius: 0 !important;
  }
}
</style>

<!-- STEP 4: ãƒœã‚¿ãƒ³åˆ¶å¾¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆå…¨ç—…é™¢å…±é€šï¼‰ -->
<script>
(function() {
  // ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã®ã‚’ç›£è¦–ã—ã¦ã€è¨­å®šã‚’é©ç”¨ã™ã‚‹
  var cfg = window.VET_CHAT_CONFIG || {};
  var applied = false;

  function applyConfig(btn) {
    if (applied) return;
    applied = true;

    // ãƒ†ãƒ¼ãƒã‚«ãƒ©ãƒ¼ã‚’é©ç”¨
    if (cfg.themeColor) {
      document.documentElement.style.setProperty('--vet-theme', cfg.themeColor);
    }

    // å·¦é…ç½®ã®å ´åˆ
    if (cfg.position === 'left') {
      btn.style.setProperty('right', 'unset', 'important');
      btn.style.setProperty('left', 'var(--vet-btn-side)', 'important');
      var win = document.getElementById('dify-chatbot-bubble-window');
      if (win) {
        win.style.setProperty('right', 'unset', 'important');
        win.style.setProperty('left', 'var(--vet-btn-side)', 'important');
      }
      // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¯å¾Œã‹ã‚‰ç”Ÿæˆã•ã‚Œã‚‹ã®ã§MutationObserverã§è¿½è·¡
      var winObserver = new MutationObserver(function() {
        var w = document.getElementById('dify-chatbot-bubble-window');
        if (w) {
          w.style.setProperty('right', 'unset', 'important');
          w.style.setProperty('left', 'var(--vet-btn-side)', 'important');
          winObserver.disconnect();
        }
      });
      winObserver.observe(document.body, { childList: true, subtree: true });
    }

    // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã‚’é©ç”¨
    if (cfg.iconUrl && cfg.iconUrl !== '') {
      var img = new Image();
      img.onload = function() {
        // ã‚«ã‚¹ã‚¿ãƒ ç”»åƒãŒèª­ã‚ãŸã‚‰èƒŒæ™¯ç”»åƒã¨ã—ã¦è¨­å®š
        btn.style.setProperty('background-image', "url('" + cfg.iconUrl + "')", 'important');
        btn.style.setProperty('background-size', 'cover', 'important');
        btn.style.setProperty('border-radius', '16px', 'important');
        // ::afterã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ã‚’éè¡¨ç¤ºã«ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
        btn.classList.add('vet-custom-icon');
      };
      img.onerror = function() {
        // èª­ã¿è¾¼ã¿å¤±æ•— â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè‚‰çƒã‚¢ã‚¤ã‚³ãƒ³ã®ã¾ã¾ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
        console.warn('[VetChat] ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚');
      };
      img.src = cfg.iconUrl;
    }

    // ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å±æ€§ã‚’è¿½åŠ 
    btn.setAttribute('aria-label', 'AIãƒãƒ£ãƒƒãƒˆã§è³ªå•ã™ã‚‹');
    btn.setAttribute('role', 'button');
    btn.setAttribute('tabindex', '0');
    btn.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        btn.click();
      }
    });
  }

  // DifyãŒãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆã™ã‚‹ã®ã‚’å¾…ã¤
  var observer = new MutationObserver(function() {
    var btn = document.getElementById('dify-chatbot-bubble-button');
    if (btn) {
      applyConfig(btn);
      observer.disconnect();
    }
  });

  if (document.body) {
    observer.observe(document.body, { childList: true, subtree: true });
  } else {
    document.addEventListener('DOMContentLoaded', function() {
      observer.observe(document.body, { childList: true, subtree: true });
    });
  }

  // 10ç§’ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç„¡é™ç›£è¦–ã‚’é˜²æ­¢ï¼‰
  setTimeout(function() { observer.disconnect(); }, 10000);
})();
</script>

<!-- ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³ä½¿ç”¨æ™‚ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ã‚¤ã‚³ãƒ³ã‚’æ¶ˆã™CSS -->
<style>
#dify-chatbot-bubble-button.vet-custom-icon::after {
  display: none !important;
}
</style>

<!-- â”â”â”â”â”â” åŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ ã“ã“ã¾ã§ â”â”â”â”â”â” -->
